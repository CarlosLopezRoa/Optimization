%%
clear all
clc
A = randn(10,10);
b = randn (10,1);
x = randn(10,1);

e=[];
for i=1:1000
    delta = 2*A'*(A*x-b);
    t = .01;
    x = x - t*delta;
    e(i)=sum((A*x-b).^2);
end
plot(e)

%%
cd /Users/poincare/Dropbox/Courseware_/Op/Lab/Lab001
clear all
clc
x = importdata('data_x.txt');
y = importdata('data_y.txt');
wi= randn(10,1);
e=[];
    v = 0;
    g = 1;
    t = .001;
for i=1:1
    delta = [(2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[1 0 0 0]',[1,0])); (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 1 0 0]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 0 1 0]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 0 0 1]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[1 0 0 0]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 1 0 0]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 0 1 0]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 0 0 1]',[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])) ; (2*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))];
    v = g*v + t*delta;
    wi = wi - v + .001*randn(10,1);
    e(i) = norm(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y);
end
loglog(e)
sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])

%%
cd /Users/poincare/Dropbox/Courseware_/Op/Lab/Lab001/ds1
clear all
clc
x = importdata('data_x.txt');
y = importdata('data_y.txt');
wi= randn(10,1);
e=[];
    v = 0;
    g = .9;
    t = .001;
for i=1:1
    d = (sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y);
    delta = [((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[1 0 0 0]',[1,0])); ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 1 0 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 0 1 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 0 0 1]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[1 0 0 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 1 0 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 0 1 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 0 0 1]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))];
    v = g*v + t*delta;
    wi = wi - v ;%+ .001*randn(10,1);
    e(i) = sum((1./(1+d)+1./(1-d)));
end
loglog(e)
sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])
sum(abs(delta))

%%
cd /Users/poincare/Dropbox/Courseware_/Op/Lab/Lab001/ds1
clear all
clc
global x 
x = importdata('data_x.txt');
global y 
y = importdata('data_y.txt');
w0= randn(10,1);
opt = optimset('GradObj','on');
[wi,fval] = fminunc(@myfun,w0)
    d = (sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])- y);
    delta = [((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[1 0 0 0]',[1,0])); ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 1 0 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 0 1 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0]))*([zeros(1,8) 1 0]*wi))'*sigmf(x*[0 0 0 1]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[1 0 0 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 1 0 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 0 1 0]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*((1-sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))*([zeros(1,9) 1]*wi))'*sigmf(x*[0 0 0 1]',[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])) ; ((4*d)./((d.^2-1).^2))'*(sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0])*(1-sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]))'*sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0]))];
sum(abs(delta))
[sigmf(sigmf(sigmf(x,[1,0])*([eye(4) zeros(4,6)]*wi),[1,0])*([zeros(1,8) 1 0]*wi) + sigmf(sigmf(x,[1,0])*([zeros(4,4) eye(4) zeros(4,2)]*wi),[1,0])*([zeros(1,9) 1]*wi),[1,0]) , y]